O(log(n) * N) time